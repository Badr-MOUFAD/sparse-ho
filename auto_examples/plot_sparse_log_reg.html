<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Method comparison on Lasso &#8212; sparse-ho 0.1.dev documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          sparse-ho</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1.dev</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="index.html">Examples</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="https://github.com/QB3/sparse-ho">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/QB3/sparse-ho/">Fork sparse-ho on Github</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-sparse-log-reg-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="method-comparison-on-lasso">
<span id="sphx-glr-auto-examples-plot-sparse-log-reg-py"></span><h1>Method comparison on Lasso<a class="headerlink" href="#method-comparison-on-lasso" title="Permalink to this headline">Â¶</a></h1>
<p>The aim of this example is to demonstrate on a simple
dateset how methods compare.</p>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.01
0 -st iteration over 10000
0.6387291116694195
1 -st iteration over 10000
0.6311273599700443
2 -st iteration over 10000
0.6276421805430861
relative decrease =  0.005028051075880909
0 -st iterations over 100
1 -st iterations over 100
2 -st iterations over 100
3 -st iterations over 100
4 -st iterations over 100
5 -st iterations over 100
6 -st iterations over 100
7 -st iterations over 100
8 -st iterations over 100
9 -st iterations over 100
grad lambda 0.031092942663294095
value of lambda_k -3.918203883094459
0.01
0 -st iteration over 10000
0.48582475063781727
1 -st iteration over 10000
0.46943326844496414
2 -st iteration over 10000
0.4626517899774521
relative decrease =  0.012236485526102578
3 -st iteration over 10000
0.45880950197874376
relative decrease =  0.0069330164076391015
0 -st iterations over 100
1 -st iterations over 100
2 -st iterations over 100
3 -st iterations over 100
4 -st iterations over 100
5 -st iterations over 100
6 -st iterations over 100
7 -st iterations over 100
8 -st iterations over 100
9 -st iterations over 100
grad lambda 0.017989210750400744
value of lambda_k -5.136230206383936
0.01
0 -st iteration over 10000
0.395685722640273
1 -st iteration over 10000
0.39342905662334676
2 -st iteration over 10000
0.3922600012008751
relative decrease =  0.0028652823666013307
0 -st iterations over 100
1 -st iterations over 100
2 -st iterations over 100
3 -st iterations over 100
4 -st iterations over 100
5 -st iterations over 100
grad lambda -0.028717547694547183
value of lambda_k -3.1918019867356517
1e-05
0 -st iteration over 10000
0.701739594820278
1 -st iteration over 10000
0.6933971947836545
2 -st iteration over 10000
0.6931509568400631
relative decrease =  7.267825307475878e-05
3 -st iteration over 10000
0.69314754047025
relative decrease =  1.0083571453543073e-06
1e-05
0 -st iteration over 10000
0.6427098175337641
1 -st iteration over 10000
0.6351271068355719
2 -st iteration over 10000
0.6320990940720892
relative decrease =  0.004369461398048136
3 -st iteration over 10000
0.6309381415415444
relative decrease =  0.001675269446799612
4 -st iteration over 10000
0.630410514601008
relative decrease =  0.0007613724674634519
5 -st iteration over 10000
0.6302001811025697
relative decrease =  0.0003035139459206704
6 -st iteration over 10000
0.630091358312025
relative decrease =  0.0001570326876581629
7 -st iteration over 10000
0.6300485093137268
relative decrease =  6.183165614985647e-05
8 -st iteration over 10000
0.6300295328283783
relative decrease =  2.738331264684486e-05
9 -st iteration over 10000
0.6300194295308068
relative decrease =  1.457918845780328e-05
10 -st iteration over 10000
0.6300137635985354
relative decrease =  8.1760132064914e-06
1e-05
0 -st iteration over 10000
0.5382898785526702
1 -st iteration over 10000
0.5304006249395677
2 -st iteration over 10000
0.5269073414782219
relative decrease =  0.006147143276595355
3 -st iteration over 10000
0.5246861238497071
relative decrease =  0.003908684526196294
4 -st iteration over 10000
0.5230594912600789
relative decrease =  0.002862391127850807
5 -st iteration over 10000
0.5219689399282694
relative decrease =  0.0019190470402112706
6 -st iteration over 10000
0.5211345047730754
relative decrease =  0.0014683584973174248
7 -st iteration over 10000
0.5204483298659032
relative decrease =  0.0012074644138862463
8 -st iteration over 10000
0.5198722248907998
relative decrease =  0.0010137739646686752
9 -st iteration over 10000
0.5194238320459514
relative decrease =  0.0007890384768320326
10 -st iteration over 10000
0.5190649138667495
relative decrease =  0.0006315895908656817
11 -st iteration over 10000
0.5187727568576685
relative decrease =  0.0005141097234033446
12 -st iteration over 10000
0.5185250402326148
relative decrease =  0.00043590782226797634
13 -st iteration over 10000
0.5183220839635323
relative decrease =  0.00035714286536964445
14 -st iteration over 10000
0.5181534733435954
relative decrease =  0.00029670470495066534
15 -st iteration over 10000
0.5180112624058589
relative decrease =  0.0002502490907017058
16 -st iteration over 10000
0.5178904138882443
relative decrease =  0.0002126575643692706
17 -st iteration over 10000
0.5177870027979704
relative decrease =  0.00018197286173211996
18 -st iteration over 10000
0.517697947962788
relative decrease =  0.00015671010881232613
19 -st iteration over 10000
0.5176208031683401
relative decrease =  0.0001357519679584941
20 -st iteration over 10000
0.5175536066000388
relative decrease =  0.00011824603918192731
21 -st iteration over 10000
0.5174947712570861
relative decrease =  0.00010353276132894844
22 -st iteration over 10000
0.5174430036708408
relative decrease =  9.109560482403327e-05
23 -st iteration over 10000
0.517398163536812
relative decrease =  7.890534262879147e-05
24 -st iteration over 10000
0.5173606168233714
relative decrease =  6.6071084593753e-05
25 -st iteration over 10000
0.5173282449742092
relative decrease =  5.696485759908893e-05
26 -st iteration over 10000
0.5172999748724024
relative decrease =  4.974699825330974e-05
27 -st iteration over 10000
0.5172751303899484
relative decrease =  4.371892374823073e-05
28 -st iteration over 10000
0.5172531889432576
relative decrease =  3.861044143627361e-05
29 -st iteration over 10000
0.5172337275890518
relative decrease =  3.424621390817098e-05
30 -st iteration over 10000
0.5172163987900967
relative decrease =  3.049354888232365e-05
31 -st iteration over 10000
0.5172009142349333
relative decrease =  2.7248226551660577e-05
32 -st iteration over 10000
0.517187032837478
relative decrease =  2.4427144255887073e-05
33 -st iteration over 10000
0.5171745515840516
relative decrease =  2.196330585046709e-05
34 -st iteration over 10000
0.5171632984446168
relative decrease =  1.9802189310495575e-05
35 -st iteration over 10000
0.5171531268122891
relative decrease =  1.7899057424739703e-05
36 -st iteration over 10000
0.5171439110930478
relative decrease =  1.6216933781614046e-05
37 -st iteration over 10000
0.5171355431742648
relative decrease =  1.4725056313127618e-05
38 -st iteration over 10000
0.5171279295735549
relative decrease =  1.339768012883782e-05
39 -st iteration over 10000
0.5171209891201138
relative decrease =  1.2213140496299803e-05
40 -st iteration over 10000
0.5171146510566971
relative decrease =  1.1153112637472876e-05
41 -st iteration over 10000
0.5171088534765418
relative decrease =  1.020202232840379e-05
42 -st iteration over 10000
0.5171035420288681
relative decrease =  9.34657327913904e-06
1e-05
0 -st iteration over 10000
0.4358294742584683
1 -st iteration over 10000
0.4320645442280489
2 -st iteration over 10000
0.4304104672917077
relative decrease =  0.0036663622148573583
3 -st iteration over 10000
0.4294235530877764
relative decrease =  0.002187555407551588
4 -st iteration over 10000
0.42871378262592763
relative decrease =  0.0015732494331856042
5 -st iteration over 10000
0.42821322937770684
relative decrease =  0.0011095067439004722
6 -st iteration over 10000
0.4278507701378674
relative decrease =  0.0008034129683911991
7 -st iteration over 10000
0.4275668178857381
relative decrease =  0.0006293974513261226
8 -st iteration over 10000
0.42732095903003026
relative decrease =  0.0005449611193715849
9 -st iteration over 10000
0.4271187771957222
relative decrease =  0.0004481483427712873
10 -st iteration over 10000
0.4269623002453842
relative decrease =  0.00034684068534595296
11 -st iteration over 10000
0.42682335218779965
relative decrease =  0.0003079868275550485
12 -st iteration over 10000
0.42670509811657414
relative decrease =  0.00026211734712490865
13 -st iteration over 10000
0.4265993714158817
relative decrease =  0.000234349667783687
14 -st iteration over 10000
0.42650200876108135
relative decrease =  0.00021581025093541173
15 -st iteration over 10000
0.4264171112575371
relative decrease =  0.00018818048440891088
16 -st iteration over 10000
0.4263467903645401
relative decrease =  0.00015587053983692206
17 -st iteration over 10000
0.42628353278714887
relative decrease =  0.00014021427084500031
18 -st iteration over 10000
0.4262277693836415
relative decrease =  0.00012360297825295802
19 -st iteration over 10000
0.4261768907859013
relative decrease =  0.00011277550892650449
20 -st iteration over 10000
0.4261299467104297
relative decrease =  0.00010405440081963697
21 -st iteration over 10000
0.4260862932770095
relative decrease =  9.676049240775578e-05
22 -st iteration over 10000
0.42604545252249326
relative decrease =  9.052601840620834e-05
23 -st iteration over 10000
0.42600705306051806
relative decrease =  8.511474488493257e-05
24 -st iteration over 10000
0.4259707980561234
relative decrease =  8.036142412214882e-05
25 -st iteration over 10000
0.4259364453331577
relative decrease =  7.614490154098341e-05
26 -st iteration over 10000
0.42590377323684797
relative decrease =  7.241969025649577e-05
27 -st iteration over 10000
0.4258725929145069
relative decrease =  6.911308244900158e-05
28 -st iteration over 10000
0.42584275165995644
relative decrease =  6.614495718063783e-05
29 -st iteration over 10000
0.425814120555988
relative decrease =  6.346258475241088e-05
30 -st iteration over 10000
0.42578658910622835
relative decrease =  6.102513426145551e-05
31 -st iteration over 10000
0.4257600617169819
relative decrease =  5.8799573015746984e-05
32 -st iteration over 10000
0.4257344551095932
relative decrease =  5.6758603979030385e-05
33 -st iteration over 10000
0.4257096963067907
relative decrease =  5.487939350693016e-05
34 -st iteration over 10000
0.4256857210207563
relative decrease =  5.3142680896849076e-05
35 -st iteration over 10000
0.4256624723422929
relative decrease =  5.153211098645984e-05
36 -st iteration over 10000
0.4256398996638977
relative decrease =  5.0033715686313185e-05
37 -st iteration over 10000
0.42561795778817557
relative decrease =  4.863550316387584e-05
38 -st iteration over 10000
0.42559660618492606
relative decrease =  4.732712829778237e-05
39 -st iteration over 10000
0.4255758083685643
relative decrease =  4.6099625951507316e-05
40 -st iteration over 10000
0.4255555313736425
relative decrease =  4.494519352683584e-05
41 -st iteration over 10000
0.42553574531086225
relative decrease =  4.385701255151777e-05
42 -st iteration over 10000
0.42551642298951603
relative decrease =  4.282910143454317e-05
43 -st iteration over 10000
0.42549806997369033
relative decrease =  4.068057674564316e-05
44 -st iteration over 10000
0.4254813440935127
relative decrease =  3.707393153622345e-05
45 -st iteration over 10000
0.42546516696163816
relative decrease =  3.585759751942971e-05
46 -st iteration over 10000
0.4254494661715044
relative decrease =  3.4801757055566166e-05
47 -st iteration over 10000
0.42543419747138644
relative decrease =  3.384400323383013e-05
48 -st iteration over 10000
0.4254193264815334
relative decrease =  3.296245422252818e-05
49 -st iteration over 10000
0.4254048242438849
relative decrease =  3.214509251479818e-05
50 -st iteration over 10000
0.42539066563138
relative decrease =  3.138342646725832e-05
51 -st iteration over 10000
0.42537682850082914
relative decrease =  3.0670842147134515e-05
52 -st iteration over 10000
0.42536329313195276
relative decrease =  3.0001969027085668e-05
53 -st iteration over 10000
0.42535004182101144
relative decrease =  2.937233732310462e-05
54 -st iteration over 10000
0.42533705857287607
relative decrease =  2.877815979643697e-05
55 -st iteration over 10000
0.42532432886020405
relative decrease =  2.821618300895206e-05
56 -st iteration over 10000
0.4253118394302162
relative decrease =  2.768358181316832e-05
57 -st iteration over 10000
0.42529957814638764
relative decrease =  2.7177881963703436e-05
58 -st iteration over 10000
0.4252875338565499
relative decrease =  2.6696901574366046e-05
59 -st iteration over 10000
0.4252756962815357
relative decrease =  2.6238705584919314e-05
60 -st iteration over 10000
0.4252640559201759
relative decrease =  2.5801569515440083e-05
61 -st iteration over 10000
0.42525260396757064
relative decrease =  2.538395004235187e-05
62 -st iteration over 10000
0.42524133224429805
relative decrease =  2.4984460755711156e-05
63 -st iteration over 10000
0.4252302331347531
relative decrease =  2.4601851921201725e-05
64 -st iteration over 10000
0.425219299533178
relative decrease =  2.42349934314255e-05
65 -st iteration over 10000
0.42520852479622623
relative decrease =  2.3882860323518846e-05
66 -st iteration over 10000
0.4251979027011157
relative decrease =  2.3544520390975148e-05
67 -st iteration over 10000
0.42518742740858556
relative decrease =  2.321912353543039e-05
68 -st iteration over 10000
0.4251772027648929
relative decrease =  2.266354512992669e-05
69 -st iteration over 10000
0.42516740061295755
relative decrease =  2.172706643233651e-05
70 -st iteration over 10000
0.4251577875252129
relative decrease =  2.1307994145125157e-05
71 -st iteration over 10000
0.4251483448514305
relative decrease =  2.0930261224460125e-05
72 -st iteration over 10000
0.42513906063006246
relative decrease =  2.057904180286956e-05
73 -st iteration over 10000
0.4251300890402573
relative decrease =  1.9886074913568352e-05
74 -st iteration over 10000
0.42512152310273243
relative decrease =  1.8986921941740467e-05
75 -st iteration over 10000
0.4251132029059192
relative decrease =  1.8442222695946655e-05
76 -st iteration over 10000
0.4251050896366283
relative decrease =  1.7983555246778877e-05
77 -st iteration over 10000
0.4250971603407417
relative decrease =  1.757576699751266e-05
78 -st iteration over 10000
0.4250893993508729
relative decrease =  1.7202706463989846e-05
79 -st iteration over 10000
0.4250817948271244
relative decrease =  1.6855889784244477e-05
80 -st iteration over 10000
0.4250743371803467
relative decrease =  1.6530328037765103e-05
81 -st iteration over 10000
0.42506701828009996
relative decrease =  1.6222787906304628e-05
82 -st iteration over 10000
0.4250598310212933
relative decrease =  1.5930996641205557e-05
83 -st iteration over 10000
0.42505276906767164
relative decrease =  1.565325007117755e-05
84 -st iteration over 10000
0.4250458755404215
relative decrease =  1.5279922766415857e-05
85 -st iteration over 10000
0.4250399091178757
relative decrease =  1.3224938755376952e-05
86 -st iteration over 10000
0.4250343045252842
relative decrease =  1.2422920636741911e-05
87 -st iteration over 10000
0.4250289623065749
relative decrease =  1.1841352955792798e-05
88 -st iteration over 10000
0.4250238380572128
relative decrease =  1.1358210629731882e-05
89 -st iteration over 10000
0.4250189059230505
relative decrease =  1.093237559498246e-05
90 -st iteration over 10000
0.42501414789182534
relative decrease =  1.0546465837138387e-05
91 -st iteration over 10000
0.4250095500400141
relative decrease =  1.0191418415812561e-05
92 -st iteration over 10000
0.42500510093519456
relative decrease =  9.86171165438899e-06
1e-05
0 -st iteration over 10000
0.37964997089190045
1 -st iteration over 10000
0.3788407702007023
2 -st iteration over 10000
0.37835785452200915
relative decrease =  0.0012567355712573085
3 -st iteration over 10000
0.3780375726948368
relative decrease =  0.0008334986474741716
4 -st iteration over 10000
0.3778210552605536
relative decrease =  0.0005634630919365205
5 -st iteration over 10000
0.3776536016941483
relative decrease =  0.0004357797079708414
6 -st iteration over 10000
0.3775191891220488
relative decrease =  0.0003497941111350405
7 -st iteration over 10000
0.37740303247891327
relative decrease =  0.00030228504003286945
8 -st iteration over 10000
0.3772990476087872
relative decrease =  0.00027060932358558346
9 -st iteration over 10000
0.37720355800637273
relative decrease =  0.0002485013126188475
10 -st iteration over 10000
0.37711573220452416
relative decrease =  0.00022855710453632914
11 -st iteration over 10000
0.3770344669076591
relative decrease =  0.00021148410330236114
12 -st iteration over 10000
0.37695922069806703
relative decrease =  0.00019582008281979936
13 -st iteration over 10000
0.3768937133496636
relative decrease =  0.00017047575498094228
14 -st iteration over 10000
0.37683578522155703
relative decrease =  0.00015075165785646954
15 -st iteration over 10000
0.3767813963985298
relative decrease =  0.0001415410010337612
16 -st iteration over 10000
0.3767297233392805
relative decrease =  0.00013447352094681148
17 -st iteration over 10000
0.376682822454713
relative decrease =  0.00012205445497008599
18 -st iteration over 10000
0.37664093997248693
relative decrease =  0.0001089946082689123
19 -st iteration over 10000
0.3766012404791457
relative decrease =  0.00010331361693992401
20 -st iteration over 10000
0.3765634557953981
relative decrease =  9.833053307115874e-05
21 -st iteration over 10000
0.3765274845591232
relative decrease =  9.361123310620384e-05
22 -st iteration over 10000
0.37649466409033566
relative decrease =  8.541170314097163e-05
23 -st iteration over 10000
0.3764656036293953
relative decrease =  7.56266913506031e-05
24 -st iteration over 10000
0.3764387930593149
relative decrease =  6.977159490229752e-05
25 -st iteration over 10000
0.3764146955645615
relative decrease =  6.271111121665479e-05
26 -st iteration over 10000
0.37639289498885276
relative decrease =  5.673362902852707e-05
27 -st iteration over 10000
0.37637301890634023
relative decrease =  5.172534463642973e-05
28 -st iteration over 10000
0.3763554391142251
relative decrease =  4.5749498434582126e-05
29 -st iteration over 10000
0.37633916098122816
relative decrease =  4.236207204176479e-05
30 -st iteration over 10000
0.37632386346176233
relative decrease =  3.981013189866804e-05
31 -st iteration over 10000
0.37630938805604996
relative decrease =  3.76706702013543e-05
32 -st iteration over 10000
0.37629561416543755
relative decrease =  3.584505339331686e-05
33 -st iteration over 10000
0.3762824468667613
relative decrease =  3.4266463802895355e-05
34 -st iteration over 10000
0.37626996584183586
relative decrease =  3.248051094969934e-05
35 -st iteration over 10000
0.3762581396434214
relative decrease =  3.077639612033189e-05
36 -st iteration over 10000
0.3762467287160604
relative decrease =  2.9695698334798262e-05
37 -st iteration over 10000
0.37623568645674094
relative decrease =  2.8736279822974217e-05
38 -st iteration over 10000
0.37622497481640493
relative decrease =  2.7875879849665977e-05
39 -st iteration over 10000
0.3762146578562573
relative decrease =  2.6848767552689377e-05
40 -st iteration over 10000
0.3762048157366971
relative decrease =  2.5613046528774906e-05
41 -st iteration over 10000
0.37619527271389874
relative decrease =  2.4834679711565962e-05
42 -st iteration over 10000
0.37618599452676116
relative decrease =  2.414547368629585e-05
43 -st iteration over 10000
0.3761770351444634
relative decrease =  2.331581873792833e-05
44 -st iteration over 10000
0.3761683990549049
relative decrease =  2.247448451885933e-05
45 -st iteration over 10000
0.3761599820416704
relative decrease =  2.1904362194607394e-05
46 -st iteration over 10000
0.3761517664853964
relative decrease =  2.1380092348935884e-05
47 -st iteration over 10000
0.3761437373451693
relative decrease =  2.089496484620717e-05
48 -st iteration over 10000
0.37613588159377337
relative decrease =  2.044373925683581e-05
49 -st iteration over 10000
0.3761281878181
relative decrease =  2.0022215042156864e-05
50 -st iteration over 10000
0.37612064592490824
relative decrease =  1.9626957390027406e-05
51 -st iteration over 10000
0.37611326322428096
relative decrease =  1.9212676041815788e-05
52 -st iteration over 10000
0.37610604798328146
relative decrease =  1.8776880559787353e-05
53 -st iteration over 10000
0.37609896041934177
relative decrease =  1.844461488737132e-05
54 -st iteration over 10000
0.37609199400186855
relative decrease =  1.8129344374397778e-05
55 -st iteration over 10000
0.37608514287950945
relative decrease =  1.7829301369991484e-05
56 -st iteration over 10000
0.37607840172697654
relative decrease =  1.7543116848686222e-05
57 -st iteration over 10000
0.3760719120606994
relative decrease =  1.6888651199202822e-05
58 -st iteration over 10000
0.37606623077512297
relative decrease =  1.4784928279185081e-05
59 -st iteration over 10000
0.37606071243693645
relative decrease =  1.4360875405807092e-05
60 -st iteration over 10000
0.3760553200066709
relative decrease =  1.4033213724942942e-05
61 -st iteration over 10000
0.3760500402488942
relative decrease =  1.3739995817814316e-05
62 -st iteration over 10000
0.3760448637722931
relative decrease =  1.3471217782725525e-05
63 -st iteration over 10000
0.376039783403819
relative decrease =  1.322110682720549e-05
64 -st iteration over 10000
0.3760347933358587
relative decrease =  1.2986109553648536e-05
65 -st iteration over 10000
0.3760298886621217
relative decrease =  1.2763880368015062e-05
66 -st iteration over 10000
0.376025065113186
relative decrease =  1.2552761889241518e-05
67 -st iteration over 10000
0.3760203188974376
relative decrease =  1.2351510673750881e-05
68 -st iteration over 10000
0.37601564659960335
relative decrease =  1.2159147335388008e-05
69 -st iteration over 10000
0.3760110451120917
relative decrease =  1.1974871166365436e-05
70 -st iteration over 10000
0.37600680787134666
relative decrease =  1.1026958542120212e-05
71 -st iteration over 10000
0.37600332859012353
relative decrease =  9.054451260200504e-06

(-3.0168161717625686, 0.6624064706573191)
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Quentin Bertrand &lt;quentin.bertrand@inria.fr&gt;</span>
<span class="c1">#          Quentin Klopfenstein &lt;quentin.klopfenstein@u-bourgogne.fr&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>


<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># import matplotlib.pyplot as plt</span>
<span class="c1"># import seaborn as sns</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <a href="http://docs.scipy.org/doc/scipy-0.17.0/reference/generated/scipy.sparse.html#scipy.sparse.csc_matrix" title="scipy.sparse.csc_matrix" class="sphx-glr-backref-module-scipy-sparse sphx-glr-backref-type-scipy-optimize-class"><span class="n">csc_matrix</span></a>

<span class="kn">from</span> <span class="nn">sparse_ho.ho</span> <span class="kn">import</span> <span class="n">grad_search</span>
<span class="kn">from</span> <span class="nn">sparse_ho.utils</span> <span class="kn">import</span> <span class="n">Monitor</span>
<span class="kn">from</span> <span class="nn">sparse_ho.models</span> <span class="kn">import</span> <span class="n">SparseLogreg</span>
<span class="kn">from</span> <span class="nn">sparse_ho.criterion</span> <span class="kn">import</span> <span class="n">Logistic</span>
<span class="kn">from</span> <span class="nn">sparse_ho.implicit_forward</span> <span class="kn">import</span> <span class="n">ImplicitForward</span>
<span class="kn">from</span> <span class="nn">sparse_ho.forward</span> <span class="kn">import</span> <span class="n">Forward</span>
<span class="kn">from</span> <span class="nn">sparse_ho.grid_search</span> <span class="kn">import</span> <span class="n">grid_search</span>
<span class="c1"># from sparse_ho.bayesian import hyperopt_lasso</span>

<span class="kn">from</span> <span class="nn">sparse_ho.datasets.real</span> <span class="kn">import</span> <span class="n">get_rcv1</span>
<span class="c1"># from expes.utils import configure_plt</span>

<span class="nb">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>

<a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">X_train</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">X_val</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/scipy-0.17.0/reference/generated/scipy.sparse.html#scipy.sparse.csc_matrix" title="scipy.sparse.csc_matrix" class="sphx-glr-backref-module-scipy-sparse sphx-glr-backref-type-scipy-optimize-class"><span class="n">X_test</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">y_train</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">y_val</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">y_test</span></a> <span class="o">=</span> <span class="n">get_rcv1</span><span class="p">()</span>

<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">1000</span>
<a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">X_train</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">y_train</span></a> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span> <span class="n">n_informative</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">flip_y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_redundant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a href="http://docs.scipy.org/doc/scipy-0.17.0/reference/generated/scipy.sparse.html#scipy.sparse.csc_matrix" title="scipy.sparse.csc_matrix" class="sphx-glr-backref-module-scipy-sparse sphx-glr-backref-type-scipy-optimize-class"><span class="n">X_train_s</span></a> <span class="o">=</span> <a href="http://docs.scipy.org/doc/scipy-0.17.0/reference/generated/scipy.sparse.html#scipy.sparse.csc_matrix" title="scipy.sparse.csc_matrix" class="sphx-glr-backref-module-scipy-sparse sphx-glr-backref-type-scipy-optimize-class"><span class="n">csc_matrix</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">X_train</span></a><span class="p">)</span>


<a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">X_val</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">y_val</span></a> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span> <span class="n">n_informative</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">flip_y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n_redundant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># X_val_s = csc_matrix(X_val)</span>


<span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">X_train</span></a><span class="o">.</span><span class="n">shape</span>

<span class="n">alpha_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">X_train</span><span class="o">.</span><span class="n">T</span></a> <span class="o">@</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">y_train</span></a><span class="p">))</span>
<span class="n">alpha_max</span> <span class="o">/=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n_samples</span>
<span class="n">log_alpha_max</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.log" title="numpy.log" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="n">alpha_max</span><span class="p">)</span>
<span class="n">log_alpha_min</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.log" title="numpy.log" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="n">alpha_max</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">maxit</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">log_alpha0</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.log" title="numpy.log" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-data"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="mf">0.3</span> <span class="o">*</span> <span class="n">alpha_max</span><span class="p">)</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-2</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SparseLogreg</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">X_train</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">y_train</span></a><span class="p">,</span> <span class="n">log_alpha0</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>
<span class="n">criterion</span> <span class="o">=</span> <span class="n">Logistic</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">X_val</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-np-class"><span class="n">y_val</span></a><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">algo</span> <span class="o">=</span> <span class="n">ImplicitForward</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">tol_jac</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">n_iter_jac</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">grad_search</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">log_alpha0</span><span class="p">,</span> <span class="n">monitor</span><span class="p">,</span> <span class="n">n_outer</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span>


<span class="n">monitor_grid</span> <span class="o">=</span> <span class="n">Monitor</span><span class="p">()</span>
<span class="n">algo_grid</span> <span class="o">=</span> <span class="n">Forward</span><span class="p">(</span><span class="n">criterion</span><span class="p">)</span>
<span class="n">grid_search</span><span class="p">(</span>
    <span class="n">algo_grid</span><span class="p">,</span> <span class="n">log_alpha_min</span><span class="p">,</span> <span class="n">log_alpha_max</span><span class="p">,</span> <span class="n">monitor_grid</span><span class="p">,</span> <span class="n">max_evals</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  3.715 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-sparse-log-reg-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a9588e66a2dbadd4c004d1e34b56758d/plot_sparse_log_reg.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_sparse_log_reg.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/a1276ee1e0940f5e73943f79ccf7cf57/plot_sparse_log_reg.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_sparse_log_reg.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020-2020, sparse-ho contributors.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>